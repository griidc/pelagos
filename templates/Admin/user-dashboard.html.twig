{% extends '@EasyAdmin/page/content.html.twig' %}

{% block page_title %}
    Datasets for {{ app.user.person.firstName ~ ' ' ~ app.user.person.lastName }}
{% endblock %}

{% block main %}
    <div class="max-w-screen-xl mx-auto py-6">
        {% for researchGroup in researchGroups %}
        <div class="rounded-lg">
            <div class="d-inline-flex bg-light">
                <span class="p-2 text-black font-bold block text-lg bg-gray-200">
                    <div class="mr-10">
                        Research Group: {{ researchGroup.name }}
                    </div>
                </span>
            </div>
        </div>


        {% set datasets = researchGroup.datasets|filter(dataset => dataset.researchGroup == researchGroup)|filter(dataset => dataset.creator == person)|sort((a, b) => a.udi <=> b.udi) %}
        <div class="ml-8">
            <table class="table-auto w-full mt-4 border-none datagrid">
                <colgroup>
                    <col style="width: 140px;">
                    <col style="width: 180px;">
                    <col style="width: 320px;">
                    <col style="width: 120px;">
                    <col style="width: 220px;">
                    <col style="width: 100px;">
                </colgroup>
                <thead>
                    <tr>
                        <th>Unique Dataset Identifier</th>
                        <th>Point of Contact</th>
                        <th>Title</th>
                        <th>Status</th>
                        <th>Details</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for dataset in datasets %}
                    <tr>
                        <td>{{ dataset.udi }}</td>
                        <td>{{ dataset.getPrimaryPointOfContact.fullName|default }}</td>
                        <td>{{ dataset.title }}</td>
                        <td class="text-center">
                            {% include 'Dashboard/datasetLifecycleStatus.html.twig' with {'datasetLifecycleStatus': dataset.getDatasetLifecycleStatus} only %}
                        </td>
                        <td>{{ dataset.getDatasetLifecycleStatus.description }}</td>
                        <td class="text-center">
                            <a href="#"><i class="fa fa-eye"></i> View</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="py-6"></div>

        {% endfor %}
    </div>

{% endblock %}